# 🔁 PRG Pattern

## PRG(Post-Redirect-Get) Pattern

- POST 요청을 처리하던 중 의도치 않게 `요청이 여러 번 발생하는 것`을 방지하기 위한 패턴
- FORM 기반 요청에 의한 POST가 일어나는 경우를 위한 패턴으로, ajax 요청에서는 사용할 필요가 없다.

### 사용법

1. POST 요청에 대한 응답으로 3xx 응답을 보낸다. (Post-Redirect)
    - 이 경우 반드시 Location 헤더에 리다이렉트될 url을 명시해야 한다. (HTTP Status Spec)
2. 요청이 성공적으로 수행되면 응답에 명시된 url로 리다이렉트되며, 그 전의 페이지는 history에서 제거된다. (뒤로가기에 의해 재요청이 발생할 일도 없음)

### 장점

form 기반 submit request에서 발생 가능한 다음의 문제를 예방할 수 있다.

- 요청 도중 새로고침 등에 의해 해당 url로 여러 번 POST 요청을 보내게 될 수 있는데, PRG 패턴을 이용하면 바로 GET으로 요청이 변경되기 때문에 여러 번 요청이 보내져도 이 요청이 GET이라 문제가 없다.
    - GET은 여러 번 발생해도 리소스를 변화시키지 않는 `안전한` HTTP 메소드에 해당
- 리다이렉트를 통해 url이 변경되게 되면 그 전의 요청 url이 브라우저 history에 저장되지 않기 때문에, 뒤로가기에 의해 요청이 재발생할 우려도 없다.
- 요청에 의해 생성된 리소스를 공유하고자 할 때에도, POST 요청의 결과를 공유하는 것은 url을 통한 리소스 접근이 불가능하다는 문제가 있는데, 최종 요청을 GET으로 함으로써 이 문제도 해결할 수 있다.
