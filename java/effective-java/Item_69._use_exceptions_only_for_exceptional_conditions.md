# Item 69. 예외는 진짜 예외 상황에만 사용하라

## 예외는 예외 상황에만 사용

- 어떤 이유에서든 `예외가 아닌데 예외를 던지지 말아야 함`

### 예외를 최적화 수단으로 사용하면 안 되는 이유

1. 예외는 예외 상황에서 쓸 용도로 설계된 것이기 때문에 최적화에 큰 신경을 쓰지 않았을 확률이 높음
    - 실제로 예외는 스택트레이스 캡처 등의 이유로 생성 비용이 높은 객체에 해당
2. try-catch 내의 코드에는 JVM이 적용할 수 있는 최적화가 제한됨
3. 임의로 최적화하려는 부분이 자연스러운 코드 흐름에 해당한다면 JVM에 의해 알아서 최적화가 되고 있을 수도 있고, 그렇지 않더라도 자바 플랫폼이 개선되며 최적화가 도입될 수도 있음
    - 오히려 임의로 예외를 이용하는 등 로직을 비트는 것이 성능 저하의 원인이 될 수도 있음
4. 임의 try-catch로 잡은 예외에 `실제 예외 상황`이 껴있으면 추적하기 매우 어려워짐

### 잘 설계된 API는 정상적 제어 흐름에서 예외가 발생하지 않아야 함

- 그래야 클라이언트 측에서 예외를 사용하지 않고 처리 가능
- 특정 상태에서만 호출 가능한 `상태 의존적 메서드`를 제공하는 클래스는 `상태 검사 메서드`도 함께 제공해야 함
    - 대표적 예시로 Iterator의 `next()`와 `hasNext()` 메서드가 존재
        - next는 hasNext가 true인 경우(정상적 제어 흐름) 예외를 던지지 않아야 함
        - 만약 hasNext가 존재하지 않는다면 next의 정상 동작 여부를 클라이언트(사용하는 측)에서 체크해야 하고, 이는 결국 try-catch 사용을 유도하게 될 것
- 상태 검사 메서드는 아래와 같은 상황에서 `Optional`, `null`로 대체 가능
    - 스레드 안정성을 보장해야 하는 경우
        - 상태 검사 메서드를 이용하게 되면 `상태 검사 메서드의 호출 시점과 상태 의존 메서드의 호출 시점 사이에 값이 바뀔 수 있기 때문`
    - 성능이 중요한데 상태 검사 메서드에서 상태 의존 메서드 작업 일부를 중복 수행하는 경우
- 상태 검사 메서드를 값 반환 방식으로 대체해야 하는 경우를 제외하고는 상태 검사 메서드를 사용하는 편이 좋음
    - 가독성이 더 뛰어나고, 클라이언트 측에서 잘못 사용했을 때 발견하기 쉽기 때문
        - 상태 검사 메서드를 호출하지 않고 상태 의존 메서드를 사용했을 때 예외를 던지면 됨
